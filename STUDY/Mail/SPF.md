# SPF

- SPFとは、電子メールの送信元ドメインの詐称を検知する技術。ドメイン名についての情報を配布するDNS（Domain Name System）の仕組みを利用して、本当に送信元アドレスに記載されたドメインから送られてきたメールかを調べることができる

- 電子メールの送受信に標準的に用いられるプロトコル（通信規約）であるSMTP（Simple Mail Transfer Mail）では送信元アドレスは送信者が任意に設定できるため、迷惑メールの送信者はメールの到達性や効果を高めるため、送信元アドレスのドメイン名に虚偽の内容を記載し、社会的に信用ある企業や団体になりすましたり、メールフィルタに排除されないよう大手ISPやネットサービスのドメインを詐称することがある。

- 自ドメインが虚偽の送信元の一部に使われることを防ぎたいドメイン管理者は、自ドメインのDNS情報にSPFレコードと呼ばれる情報を追加する。SPFレコードにはそのドメインからのメール送信に使われる可能性のあるIPアドレスを列挙し、そのアドレスを持つメールサーバからはドメイン内の正規の利用者からしかメールを送信できないよう設定しておく。SPFレコードが利用できないシステムのために、任意のテキストデータを記載できるTXTレコードを用いる方法も規定されている。

### SPFレコード
- SPFレコードとは、DNSで定義されるそのドメインについての情報（リソースレコード）の種類の一つで、電子メールの送信ドメイン認証を利用するためのもの。

- メールを受信したサーバが送信元アドレスに記載されたドメインのSPFレコードを照会することで、本当にそのドメインから送信されたものであるか（無関係な第三者が勝手にメールアドレスを使って送信した「なりすまし」メールではないか）を確かめることができる。

- SPFレコードにはそのドメインが実際に利用している正当な送信元サーバを記述し、受信側では記載されていないサーバから受け取ったメールは疑わしいと判断できる。例えば「example.jp. IN SPF “v=spf1 ip4:198.51.100.1 ~all”」のように指定すると、「～@example.jpというアドレスから来たメールは198.51.100.1が送信元でなければ偽装されている可能性がある」という意味になる。

- 末尾を「-all」にすると詐称であると断定する。送信元の指定にはIPアドレス単体以外にも、IPアドレスの範囲指定やホスト名、MXレコード、含まれるドメイン名などを用いることができる。範囲が複数に渡る場合には一つのドメインに複数の指定を併記することもできる


